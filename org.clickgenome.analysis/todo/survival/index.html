<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="Access-Control-Allow-Origin" content="*" />
    <meta name="description" content="Click: Do GWAS analysis by yourself by Clicking">
    <title>Survival Plot | ClickGWAS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico"/>
    <link rel="stylesheet" href="../../css/style.css"/>
    <link rel="stylesheet" href="../../css/todo.css"/>
    <link rel="stylesheet" href="../../css/bootstrap.min.css"/>
    <link rel="stylesheet" href="../../css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="../../css/fileinput.css"/>
    <link href="../../css/theme.css" media="all" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="../../css/jquery.dataTables.css"/>

    <script type="text/javascript" src="../../js/echarts.min.js"></script>
    <script type="text/javascript" src="../../js/jquery-2.2.1.min.js"></script>

    <script type="text/javascript" src="../../js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../js/base_component.js"></script>

    <script src="../../js/fileinput.js" type="text/javascript"></script>
    <script src="../../js/jquery.dataTables.js" type="text/javascript"></script>

</head>
<body active="home">

<div class="container-fluid navigation"></div>
<div class="container-fluid pagetitle">
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <h3><strong>Plot | Survival plot</strong></h3>
        </div>
        <div class="col-md-1"></div>
    </div>
</div>
<div class="section">
    <div class="container">
        <div class="row">
            <div class="col-md-3 left-contral-area">
                <strong class="col-md-12">Survival plot</strong>
                <p class="col-md-12">⚠️:Without non-malignant <a href=# title="abcd"><img src="../../img/image1.png"
                                                                                          alt="image1"></a></p>
                <p class="col-md-12">❌:Not available <a href=# title="abcd"><img src="../../img/image1.png"
                                                                                 alt="image1"></a></p>
                <label class="col-md-12">Cancer : <span class="glyphicon glyphicon-info-sign"></span></label>
                <select class="col-md-12 form-control" id="cancername">
                    <option class="col-md-12" value="lgg">lgg</option>
                    <option class="col-md-12" value="gbm">gbm</option>
                    <option class="col-md-12" value="luad">luad</option>
                    <option class="col-md-12" value="lusc">lusc</option>
                </select>
                <div class='col-md-12'>
                    <div class="col-md-12">
                        <input type="checkbox" name="tian" class="col-md-2" id="race" value="race"/> race
                    </div>
                    <div class="col-md-12">
                        <input type="checkbox" name="tian" class="col-md-2" id="age" value="age"/> age
                    </div>
                    <div class="col-md-12">
                        <input type="checkbox" name="tian" class="col-md-2" id="gender" value="gender"/> gender
                    </div>
                    <div class="col-md-12">
                        <input type="checkbox" name="tian" class="col-md-2" id="stage" value="stage"/> stage
                    </div>
                    <div class="col-md-12">
                        <input type="checkbox" name="tian" class="col-md-2" id="T" value="T"/> T
                    </div>
                    <div class="col-md-12">
                        <input type="checkbox" name="tian" class="col-md-2" id="N" value="N"/> N
                    </div>
                    <div class="col-md-12">
                        <input type="checkbox" name="tian" class="col-md-2" id="M" value="M"/> M
                    </div>
                    <div class="col-md-12">
                        <input type="checkbox" name="tian" class="col-md-2" id="personNeoplasmCancerStatus"
                               value="personNeoplasmCancerStatus"/> NeoplasmCancerStatus
                    </div>
                </div>
                <button class="col-md-12 btn btn-primary" id="bt_draw">GO</button>
            </div>
            <!--绘图区-->
            <div class="col-md-9 echarts" style="margin-top: 2%;">
                <div id="echarts" class="col-md-12">
                    <h1>Ploting Here</h1></div>
            </div>


            <!--底部功能区-->
            <div class="col-md-12 bottom-contral-area" id="tool_bar">
                <form enctype="multipart/form-data">

                    <!--<div>-->
                        <!--&lt;!&ndash;<input type="file" name="file" id="uploadfile" multiple class="file-loading"/>&ndash;&gt;-->
                        <!--&lt;!&ndash;<input id="f_upload" type="file" name="file" class="file"/>&ndash;&gt;-->

                        <!--<input id="uploadfile" name="file" type="file" class="file" multiple>-->
                        <!--<p class="help-block">支持zip、xls、xlsx格式，大小不超过20M</p>-->
                    <!--</div>-->


                    <form enctype="multipart/form-data">

                        <div class="form-group">
                            <input id="file-1" name="file" type="file" multiple class="file"
                                   data-overwrite-initial="false">
                            <p class="help-block">支持zip、xls格式，大小不超过20M</p>
                        </div>

                    </form>
                </form>

                <div>
                    <table id="example" cellpadding="0" cellspacing="0" border="0" width="100%">
                        <thead>
                        <tr>
                            <th width="50%">coxHighTime||coxHighSurvivalEstimate</th>
                            <th width="50%">coxLowTime||coxLowSurvivalEstimate</th>
                        </tr>
                        </thead>
                    </table>

                    <script>
                        $(document).ready(function () {
                            $.fn.dataTable.ext.errMode = 'none'; //不显示任何错误信息
                            $('#example').dataTable({
                                "text-align": "center",
                                "scrollY": "200px",
                                "scrollCollapse": true,
                                "paging": false,
                                "aoColumns": [
                                    {"mData": "coxHighTime"},

                                    {"mData": "coxLowTime"}

                                ]
                            });
                        });

                    </script>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">

    $("#file-1").fileinput({
        language: 'zh', //设置语言
        //uploadUrl: 'http://localhost:8088/click/resource/' + getCookie("utoken") + '/auth/lala/upload', //上传的地址
        uploadUrl: 'http://47.88.77.83:8080/admin/resource/' + getCookie("utoken") + '/auth/lala/upload', //上传的地址
        allowedFileExtensions: ["xls", "jpg", "zip", "xlsx", "png"],//接收的文件后缀
        //uploadExtraData:{"id": 1, "fileName":'123.mp3'},
        uploadAsync: false, //默认异步上传
        showUpload: true, //是否显示上传按钮
        showRemove: true, //显示移除按钮
        showPreview: true, //是否显示预览
        showCaption: false,//是否显示标题
        browseClass: "btn btn-primary", //按钮样式
        dropZoneEnabled: false,//是否显示拖拽区域
        maxFileSize: 0,//单位为kb，如果为0表示不限制文件大小
        minFileCount: 1,
        maxFileCount: 10, //表示允许同时上传的最大文件个数
//        enctype: 'multipart/form-data',
        validateInitialCount: true,
        previewFileIcon: "<i class='glyphicon glyphicon-king'></i>",
        msgFilesTooMany: "选择上传的文件数量({n}) 超过允许的最大数值{m}！",
    });

    //    //同步上传错误处理
    //    $('#uploadfile').on('filebatchuploaderror', function (event, data, msg) {
    //        console.log(data.id);
    //        console.log(data.index);
    //        console.log(data.file);
    //        console.log(data.reader);
    //        console.log(data.files);
    //        // get message
    //        alert(msg);
    //    });
    //    //同步上传返回结果处理
    //    $("#uploadfile").on("filebatchuploadsuccess", function (event, data, previewId, index) {
    //        console.log(data.id);
    //        console.log(data.index);
    //        console.log(data.file);
    //        console.log(data.reader);
    //        console.log(data.files);
    //        var obj = data.response;
    //        alert(JSON.stringify(data.success));
    //    });
    //
    //    //上传前
    //    $('#uploadfile').on('filepreupload', function (event, data, previewId, index) {
    //        var form = data.form, files = data.files, extra = data.extra,
    //            response = data.response, reader = data.reader;
    //        console.log('File pre upload triggered');
    //    });
</script>
<!--<script>-->
<!--//把服务器返回的数据转成datatable须要的格式-->
<!--function packagingdatatabledata(n_points, t_points) {-->
<!--var a = [];-->
<!--var tableName = ['coxHighSurvivalEstimate', 'coxHighTime', 'coxLowSurvivalEstimate', 'coxLowTime'];-->
<!--for (var i = 0; i < t_points.length; i++) {-->
<!--for (var j = 0; j < n_points.length; j++) {-->
<!--var tempObj = new Object();-->
<!--tempObj.coxHighSurvivalEstimate = t_points[i].sortedTime;-->
<!--tempObj.coxHighTime = t_points[i].sortedSurvivalEstimate;-->
<!--tempObj.coxLowSurvivalEstimate = n_points[j].sortedTime;-->
<!--tempObj.coxLowTime = n_points[j].sortedSurvivalEstimate;-->
<!--a.push(JSON.parse(JSON.stringify(tempObj, tableName)));-->
<!--}-->
<!--}-->
<!--return a;-->
<!--}-->
<!--</script>-->
<!--以下为绘图部分js-->
    <script>
        var cookie_token = getCookie("utoken");
        if (cookie_token) {
        } else {
            alert("Please register or login first!");
            window.location.href = "http://portal.clickgenome.org/";
        }
    </script>
<script src="../../js/cache.js"></script>
<script src="../../js/survival.js"></script>
<script>


    survival.View.init();
    $("#pic_width").html($("#echarts").css("width"));
    $("#pic_height").html($("#echarts").css("height"));
    $("#bt_draw").click(function () {
        var cancerType = $("#cancername").val();
        var covariates = [];
        $("input[name='tian']:checked").each(function () {
            covariates.push($(this).val());
            console.log($(this).val());
        });
        if (covariates.length == 0) {
            $("#bt_draw").Enable = false;
            alert("协变量至少要选择一个");
        }
        var cv = {coVariates: covariates};
        console.log(cv);
        survival.Operate.getSurvivalData(cancerType, cv);
    });
</script>


<!--footer-->
<div class="container-fluid footer"></div>

</body>

</html>